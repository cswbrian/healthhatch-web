{{- /* Open Graph / Facebook */ -}}
{{- $title := .Title | default .Site.Title -}}
{{- $description := .Description | default .Summary | default .Site.Params.description | truncate 160 -}}
{{- $image := "" -}}
{{- $imageAlt := $title -}}

{{- /* Get featured image with priority: page param > page image > site param > default */ -}}
{{- if .Params.featured_image -}}
  {{- $image = .Params.featured_image | absURL -}}
{{- else if .Params.image -}}
  {{- $image = .Params.image | absURL -}}
{{- else if .Site.Params.featured_image -}}
  {{- $image = .Site.Params.featured_image | absURL -}}
{{- else if .Site.Params.og_image -}}
  {{- $image = .Site.Params.og_image | absURL -}}
{{- end -}}

{{- if .Params.image_alt -}}
  {{- $imageAlt = .Params.image_alt -}}
{{- end -}}

{{- $siteName := .Site.Title -}}
{{- $url := .Permalink | absURL -}}
{{- $type := cond .IsPage "article" "website" -}}
{{- $locale := .Site.LanguageCode | default "en_US" -}}

<meta property="og:title" content="{{ $title }}">
<meta property="og:description" content="{{ $description }}">
<meta property="og:type" content="{{ $type }}">
<meta property="og:url" content="{{ $url }}">
<meta property="og:site_name" content="{{ $siteName }}">
<meta property="og:locale" content="{{ $locale }}">

{{- if $image -}}
<meta property="og:image" content="{{ $image }}">
<meta property="og:image:alt" content="{{ $imageAlt }}">
{{- if .Params.image_width -}}
<meta property="og:image:width" content="{{ .Params.image_width }}">
{{- end -}}
{{- if .Params.image_height -}}
<meta property="og:image:height" content="{{ .Params.image_height }}">
{{- end -}}
{{- end -}}

{{- /* Article specific tags */ -}}
{{- if eq $type "article" -}}
  {{- if .Params.author -}}
    {{- $author := .Params.author -}}
    {{- if reflect.IsSlice .Params.author -}}
      {{- $author = delimit .Params.author ", " -}}
    {{- end -}}
    <meta property="article:author" content="{{ $author }}">
  {{- end -}}
  {{- if .PublishDate -}}
    <meta property="article:published_time" content="{{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" }}">
  {{- end -}}
  {{- if .Lastmod -}}
    <meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
  {{- end -}}
  {{- if .Params.tags -}}
    {{- range .Params.tags -}}
      <meta property="article:tag" content="{{ . }}">
    {{- end -}}
  {{- end -}}
  {{- if .Params.categories -}}
    {{- range .Params.categories -}}
      <meta property="article:section" content="{{ . }}">
    {{- end -}}
  {{- end -}}
{{- end -}}

{{- /* Alternate language versions */ -}}
{{- if hugo.IsMultilingual -}}
  {{- range .Site.Languages -}}
    {{- if ne $.Site.Language.Lang .Lang -}}
      {{- $translation := false -}}
      {{- $langCode := .Lang -}}
      {{- if $.Translations -}}
        {{- range $.Translations -}}
          {{- if eq .Lang $langCode -}}
            {{- $translation = . -}}
          {{- end -}}
        {{- end -}}
      {{- end -}}
      {{- if $translation -}}
        <meta property="og:locale:alternate" content="{{ $langCode | replaceRE "-" "_" }}">
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}

